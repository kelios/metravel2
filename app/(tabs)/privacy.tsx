import React from 'react';
import { ScrollView, StyleSheet, Text, View } from 'react-native';
import { usePathname } from 'expo-router';
import InstantSEO from '@/components/seo/InstantSEO';
import { DESIGN_TOKENS } from '@/constants/designSystem';

const palette = DESIGN_TOKENS.colors;

export default function PrivacyScreen() {
  const pathname = usePathname();
  const SITE = process.env.EXPO_PUBLIC_SITE_URL || 'https://metravel.by';
  const canonical = `${SITE}${pathname || '/privacy'}`;

  const title = 'Политика конфиденциальности | Metravel';
  const description = 'Подробная политика конфиденциальности Metravel в соответствии с требованиями GDPR.';

  return (
    <View style={styles.root}>
      <InstantSEO
        headKey="privacy-policy"
        title={title}
        description={description}
        canonical={canonical}
        ogType="website"
      />
      <ScrollView contentContainerStyle={styles.container}>
        <Text style={styles.heading}>Политика конфиденциальности</Text>

        <Text style={styles.paragraph}>Дата вступления в силу: 27.11.2025</Text>

        <Text style={styles.subheading}>1. Кто мы</Text>
        <Text style={styles.paragraph}>
          Контролёром персональных данных является частное лицо — администратор и создатель некоммерческого проекта
          Metravel (веб-сайт и связанные с ним сервисы, далее — «Сервис»).
        </Text>
        <Text style={styles.paragraph}>
          Сайт управляется из Республики Беларусь. Несмотря на то, что администратор находится за пределами Европейского
          Союза, при обработке персональных данных пользователей из ЕС/ЕЭЗ он, в соответствующих случаях, руководствуется
          требованиями Общего регламента ЕС по защите данных (GDPR).
        </Text>

        <Text style={styles.subheading}>2. Какие данные мы обрабатываем</Text>
        <Text style={styles.paragraph}>
          При регистрации и использовании аккаунта мы обрабатываем: имя пользователя, адрес электронной почты, пароль
          (хранится в зашифрованном виде на стороне сервера), внутренний идентификатор пользователя и, при наличии,
          признак администратора/суперпользователя.
        </Text>
        <Text style={styles.paragraph}>
          Дополнительно обрабатываются данные аутентификации и безопасности (токены доступа, информация о входе/выходе,
          технические журналы ошибок), контент путешествий (название, описание, рекомендации, фотографии и метаданные,
          такие как страны, категории, длительность, год поездки и т.п.), а также технические данные устройств и
          браузеров (IP-адрес, тип устройства и браузера, настройки языка и др.). Сайт носит некоммерческий характер и
          предназначен для обмена опытом и вдохновения путешествиями, а не для продажи услуг или товаров.
        </Text>
        <Text style={styles.paragraph}>
          Мы можем запрашивать доступ к вашему примерному местоположению (геолокации устройства) только для того, чтобы
          показывать путешествия и маршруты рядом с вами и центрировать карту. Координаты используются только на стороне
          вашего устройства и не сохраняются в нашей базе данных в привязке к вашему аккаунту.
        </Text>

        <Text style={styles.subheading}>3. Цели и правовые основания обработки</Text>
        <Text style={styles.paragraph}>
          Основные цели обработки включают:
        </Text>
        <Text style={styles.paragraph}>
          • предоставление и поддержку работы Сервиса, создание и ведение аккаунта, аутентификация, восстановление
          пароля, публикация и отображение путешествий (основание — исполнение договора, ст. 6(1)(b) GDPR);
        </Text>
        <Text style={styles.paragraph}>
          • обеспечение безопасности Сервиса, предотвращение мошенничества и злоупотреблений, ведение журналов ошибок и
          технических логов (основание — наш законный интерес, ст. 6(1)(f) GDPR);
        </Text>
        <Text style={styles.paragraph}>
          • использование аналитики (например, Яндекс.Метрика и Google Analytics 4) и данных геолокации только при вашем
          согласии, а также отправка маркетинговых материалов при отдельном согласии (основание — согласие, ст. 6(1)(a)
          GDPR);
        </Text>
        <Text style={styles.paragraph}>
          • выполнение отдельных юридических обязательств, если это требуется применимым законодательством (основание —
          юридическое обязательство, ст. 6(1)(c) GDPR).
        </Text>

        <Text style={styles.subheading}>4. Cookies и локальное хранилище</Text>
        <Text style={styles.paragraph}>
          Мы используем технически необходимые файлы cookies и механизмы локального хранилища (например, localStorage,
          AsyncStorage) для поддержки вашей сессии входа, сохранения базовых настроек интерфейса и корректной работы
          Сервиса. Эти файлы необходимы для функционирования Сервиса и не требуют отдельного согласия.
        </Text>
        <Text style={styles.paragraph}>
          Аналитические инструменты (такие как Яндекс.Метрика и Google Analytics 4) используются только после того, как
          вы даёте явное согласие через баннер настроек cookies. Вы можете выбрать только необходимые файлы или принять
          необходимые и аналитические. Ваш выбор сохраняется в браузере и может быть изменён (например, через настройки
          браузера или соответствующий раздел настроек на сайте, если он предусмотрен).
        </Text>

        <Text style={styles.subheading}>5. Обработка данных о местоположении</Text>
        <Text style={styles.paragraph}>
          Мы можем запрашивать доступ к вашему примерному местоположению (геолокации устройства) только при вашем явном
          согласии, выраженном через настройки браузера или операционной системы. Эти данные используются исключительно
          для поиска путешествий рядом с вами и улучшения релевантности отображаемого контента. Координаты не
          сохраняются в нашей базе данных в привязке к вашему аккаунту, и мы не создаём долгосрочные профили на основе
          истории перемещений.
        </Text>

        <Text style={styles.subheading}>6. Международная передача данных</Text>
        <Text style={styles.paragraph}>
          Наши серверы и инфраструктура могут располагаться в Республике Беларусь, в Европейском Союзе/ЕЭЗ (например, в
          дата-центрах AWS в регионе eu-north-1), а также в других странах через аналитические и облачные сервисы. Это
          означает, что персональные данные пользователей из ЕС/ЕЭЗ могут передаваться за пределы ЕС/ЕЭЗ.
        </Text>
        <Text style={styles.paragraph}>
          В таких случаях мы по возможности используем стандартные договорные положения (Standard Contractual Clauses,
          SCC), одобренные Европейской комиссией, и другие предусмотренные законом механизмы, а также применяем
          технические и организационные меры безопасности (шифрование каналов связи, минимизация объёма передаваемых
          данных, ограничение доступа). При этом в отдельных юрисдикциях государственные органы могут иметь
          расширенные полномочия по доступу к данным в соответствии с местным законодательством.
        </Text>

        <Text style={styles.subheading}>7. Сроки хранения данных</Text>
        <Text style={styles.paragraph}>
          Мы храним персональные данные не дольше, чем это необходимо для целей, для которых они были собраны, если иное
          не требуется законом. Данные аккаунта хранятся пока ваш аккаунт активен, а после его удаления — в течение
          ограниченного периода для технического резервирования и разрешения возможных споров. Контент путешествий
          хранится, пока он опубликован или сохранён в черновиках; после удаления он удаляется или анонимизируется в
          пользовательском интерфейсе, при этом копии могут временно сохраняться в резервных копиях.
        </Text>

        <Text style={styles.subheading}>8. Ваши права</Text>
        <Text style={styles.paragraph}>
          В соответствии с применимым законодательством о защите данных, включая GDPR, вы имеете право на доступ к
          своим данным, их исправление, удаление, ограничение обработки, переносимость данных, а также право возражать
          против определённых видов обработки и право отозвать согласие, если обработка основана на согласии.
        </Text>
        <Text style={styles.paragraph}>
          Для реализации своих прав вы можете связаться с администратором Сервиса по адресу электронной почты:
          metraveldev@gmail.com. Если вы находитесь на территории ЕС/ЕЭЗ, вы также имеете право подать жалобу в
          надзорный орган по защите данных по месту вашего обычного проживания, работы или предполагаемого нарушения.
        </Text>

        <Text style={styles.subheading}>9. Контакты</Text>
        <Text style={styles.paragraph}>
          По вопросам, связанным с обработкой персональных данных и настоящей Политикой конфиденциальности, вы можете
          связаться с администратором Сервиса по адресу электронной почты: metraveldev@gmail.com.
        </Text>
      </ScrollView>
    </View>
  );
}

const styles = StyleSheet.create({
  root: {
    flex: 1,
    backgroundColor: palette.background,
  },
  container: {
    paddingHorizontal: 16,
    paddingVertical: 24,
    maxWidth: 900,
    alignSelf: 'center',
  },
  heading: {
    fontSize: 24,
    fontWeight: '700',
    color: palette.text,
    marginBottom: 16,
  },
  subheading: {
    fontSize: 18,
    fontWeight: '600',
    color: palette.text,
    marginTop: 20,
    marginBottom: 8,
  },
  paragraph: {
    fontSize: 14,
    lineHeight: 20,
    color: palette.textMuted,
    marginBottom: 8,
  },
});
