# ТЗ: Улучшение визуальной части MeTravel (frontend-only)

> Дата: 6 февраля 2026
> Область: только UI/UX, без изменений бэкенда
> Основа: анализ кодовой базы, документации, QA-отчёта и текущих компонентов

---

## Содержание

1. [Что добавить](#1-что-добавить)
2. [Что изменить](#2-что-изменить)
3. [Что удалить / убрать](#3-что-удалить--убрать)
4. [Приоритизация](#4-приоритизация)

---

## 1. Что добавить

### 1.1. Онбординг для новых пользователей (P1)

**Проблема:** Гость попадает на главную и видит hero-блок с CTA «Рассказать о путешествии», но не понимает ценность платформы до скролла к секциям «Как это работает» и «Вдохновение». Конверсия в регистрацию низкая.

**Решение:**
- Добавить **интерактивный тур** (tooltip-подсказки) при первом визите: «Здесь ты найдёшь маршруты» → «Сохраняй в избранное» → «Создай свою книгу»
- Компонент: `components/home/OnboardingTour.tsx` (уже есть `OnboardingBanner.tsx` — расширить или заменить)
- Показывать только 1 раз (флаг в `localStorage`)
- Не блокировать UI — tooltip поверх контента с кнопкой «Пропустить»

**Затрагиваемые файлы:** `components/home/Home.tsx`, `components/home/OnboardingBanner.tsx`

---

### 1.2. Пустые состояния (Empty States) с действиями (P1)

**Проблема:** На страницах `/favorites`, `/history`, `/metravel` пустые состояния показывают текст и одну кнопку, но не объясняют ценность и не мотивируют.

**Решение:**
- Для `/favorites` (пустое): добавить **иллюстрацию** (нейтральную, без emoji) + текст «Сохраняй маршруты, чтобы вернуться к ним позже» + кнопка «Найти маршруты» + подсказка «Нажми ❤ на карточке маршрута»
- Для `/history` (пустое): «Ты ещё не открывал маршруты» + кнопка «Начать исследовать»
- Для `/metravel` (пустое, авторизован): «Расскажи о своём первом путешествии» + кнопка «Создать маршрут» + краткое описание что получится (книга)
- Использовать существующий `EmptyState` компонент, расширив его поддержкой `illustration` (изображение вместо иконки)

**Затрагиваемые файлы:** `components/ui/EmptyState.tsx`, `app/(tabs)/favorites.tsx`, `app/(tabs)/history.tsx`

---

### 1.3. Уведомления и обратная связь при действиях (P1)

**Проблема:** При добавлении/удалении из избранного, успешной отправке формы обратной связи, сохранении профиля — нет визуального подтверждения (toast/snackbar). Пользователь не уверен, что действие выполнено.

**Решение:**
- Реализовать единый **toast-компонент** на базе уже существующего `ToastHost.web.tsx`
- Показывать toast при:
  - Добавлении/удалении из избранного
  - Сохранении профиля/настроек
  - Отправке формы обратной связи
  - Копировании ссылки (share)
  - Ошибках сети (offline)
- Стилизация: нейтральный фон, иконка статуса (success/error/info), автоскрытие через 3 сек

**Затрагиваемые файлы:** `components/ui/ToastHost.web.tsx`, `app/(tabs)/favorites.tsx`, `app/(tabs)/settings.tsx`, `app/(tabs)/about.tsx`

---

### 1.4. Индикатор «Вы здесь» в навигации (P2)

**Проблема:** В хедере (`CustomHeader`) и bottom dock (`BottomDock`) нет визуального выделения текущей страницы. Пользователь не видит, где находится.

**Решение:**
- В `CustomHeader`: подчёркивание или цветовое выделение активного пункта навигации (уже есть `activePath`, но не используется для стилизации)
- В `BottomDock`: заливка иконки или точка под активным элементом
- Использовать `DESIGN_TOKENS.colors.primary` для выделения

**Затрагиваемые файлы:** `components/layout/CustomHeader.tsx`, `components/layout/BottomDock.tsx`

---

### 1.5. Скелетоны для всех ключевых страниц (P2)

**Проблема:** На `/profile`, `/settings`, `/articles` при загрузке показывается либо `ActivityIndicator`, либо простой текст «Загрузка…». Это выглядит незавершённо.

**Решение:**
- Заменить все `ActivityIndicator` и текстовые лоадеры на **skeleton-лоадеры** (уже есть `SkeletonLoader`)
- Страницы для доработки: `/articles` (есть частично), `/settings` (нет скелетона), `/about` (нет)
- Скелетон должен повторять layout реального контента

**Затрагиваемые файлы:** `app/(tabs)/articles.tsx`, `app/(tabs)/settings.tsx`, `app/(tabs)/about.tsx`

---

### 1.6. «Наверх» кнопка на длинных страницах (P2)

**Проблема:** На `/travelsby`, `/search`, детальных страницах путешествий при длинном скролле нет быстрого способа вернуться наверх.

**Решение:**
- Уже есть `ScrollToTopButton.tsx` — убедиться, что он подключён на всех длинных страницах
- Показывать после скролла > 600px
- Анимация появления (fade in)

**Затрагиваемые файлы:** `components/listTravel/ListTravelBase.tsx`, `components/travel/StableContent.tsx`

---

### 1.7. Breadcrumbs на всех внутренних страницах (P3)

**Проблема:** Breadcrumbs есть на детальной странице путешествия, но отсутствуют на `/favorites`, `/history`, `/settings`, `/articles`, `/quests/*`.

**Решение:**
- Добавить breadcrumbs-компонент (переиспользовать из travel details)
- Формат: `Главная > Избранное`, `Главная > Настройки`, `Главная > Квесты > Краков > Тайна дракона`
- Только для web (на мобильном — скрывать)

**Затрагиваемые файлы:** новый `components/layout/Breadcrumbs.tsx`, страницы-потребители

---

### 1.8. Подсказки при пустом поиске / нулевых результатах фильтров (P2)

**Проблема:** На `/search` и `/travelsby` при пустых результатах фильтрации показывается только «Ничего не найдено». Нет подсказок, как расширить поиск.

**Решение:**
- При 0 результатов показывать: «Попробуйте убрать фильтры» + кнопка «Сбросить фильтры»
- Если поисковый запрос — предложить: «Проверьте написание» или «Попробуйте другие ключевые слова»
- Показать 2-3 популярных маршрута как fallback

**Затрагиваемые файлы:** `components/listTravel/ListTravelBase.tsx`, `components/listTravel/ModernFilters.tsx`

---

### 1.9. Анимация добавления в избранное (P3)

**Проблема:** При нажатии на сердечко нет визуальной обратной связи кроме смены состояния иконки.

**Решение:**
- Добавить микро-анимацию: пульсация сердечка (scale 1 → 1.3 → 1) при добавлении
- Использовать `Animated` API (уже в проекте)
- Длительность: 300ms

**Затрагиваемые файлы:** `components/travel/FavoriteButton.tsx`, `components/travel/OptimizedFavoriteButton.tsx`

---

### 1.10. Темная тема — доработка (P2)

**Проблема:** Тёмная тема реализована (`useTheme`, `DESIGN_TOKENS` с dark-палитрой, `ThemeToggle`), но переключатель темы спрятан в настройках. Многие пользователи не знают о нём.

**Решение:**
- Добавить переключатель темы в хедер (десктоп) — компактная иконка sun/moon
- `ThemeToggle` уже есть как lazy-компонент в `CustomHeader` — убедиться, что он виден
- На мобильном: оставить только в настройках (экономия места)

**Затрагиваемые файлы:** `components/layout/CustomHeader.tsx`, `components/layout/ThemeToggle.tsx`

---

## 2. Что изменить

### 2.1. Главная страница — Hero-блок (P1)

**Текущее состояние:** Hero показывает заголовок «Пиши о своих путешествиях», подзаголовок и 2 кнопки. На мобильном изображение книги скрыто. Контент статичен.

**Проблемы:**
- Заголовок ориентирован на создание контента, а не на потребление (большинство пользователей — читатели)
- На мобильном hero выглядит пусто без изображения
- Нет социального доказательства (сколько маршрутов, пользователей)

**Изменения:**
- Изменить заголовок на двойной фокус: **«Находи маршруты. Делись историями.»**
- На мобильном: показать компактное изображение или фоновую иллюстрацию вместо пустоты
- Добавить строку с цифрами: «X маршрутов • Y авторов» (данные из существующих API: `/api/travels/` count + кеш)
- Кнопки: первичная — «Найти маршрут» (для гостей), вторичная — «Рассказать о путешествии»

**Затрагиваемые файлы:** `components/home/HomeHero.tsx`

---

### 2.2. Карточки путешествий — единообразие (P1)

**Текущее состояние:** Используются минимум 4 разных компонента карточек: `RenderTravelItem`, `TabTravelCard`, `TravelCardCompact`, `UnifiedTravelCard`, `TravelListItem`. Визуально они отличаются.

**Проблемы:**
- Разный внешний вид карточек на разных страницах (главная, поиск, избранное, профиль)
- `TabTravelCard` не показывает автора и просмотры
- `RenderTravelItem` показывает автора, но layout отличается от `TabTravelCard`

**Изменения:**
- Стандартизировать: **один базовый компонент карточки** с вариантами layout (`grid`, `list`, `compact`)
- `UnifiedTravelCard` уже существует — мигрировать на него все страницы
- Обязательные элементы карточки: изображение, заголовок, страна/город, автор (если есть)
- Опциональные: просмотры, badge (избранное/история)

**Затрагиваемые файлы:** `components/ui/UnifiedTravelCard.tsx`, `app/(tabs)/favorites.tsx`, `app/(tabs)/history.tsx`, `app/(tabs)/profile.tsx`, `components/home/HomeInspirationSection.tsx`

---

### 2.3. Страница логина/регистрации — UX (P1)

**Текущее состояние:** Формы работают, есть валидация, но:
- Нет индикации силы пароля при регистрации
- Кнопка «Забыли пароль?» на странице логина — `TouchableOpacity` без визуального стиля кнопки
- Нет возможности показать/скрыть пароль на логине (есть на регистрации)

**Изменения:**
- Добавить **toggle видимости пароля** (иконка eye/eye-off) на странице логина
- Добавить **индикатор силы пароля** на регистрации (полоска: слабый/средний/сильный)
- Стилизовать «Забыли пароль?» как текстовую ссылку с hover-эффектом
- Добавить **divider** «или» между формой и ссылкой на регистрацию/логин

**Затрагиваемые файлы:** `app/(tabs)/login.tsx`, `app/(tabs)/registration.tsx`

---

### 2.4. Страница профиля — информационная архитектура (P2)

**Текущее состояние:** Профиль содержит: аватар, имя, email, quick-nav чипы, соцсети, статистику, превью избранного/истории, меню разделов, кнопку выхода. Всё на одном скролле.

**Проблемы:**
- Слишком много информации на одном экране
- Quick-nav чипы дублируют меню разделов
- Статистика (3 карточки) занимает много места, но не несёт actionable информации
- Кнопка «Выйти» внизу страницы — легко потерять

**Изменения:**
- Убрать quick-nav чипы (дублируют меню)
- Статистику сделать **компактной строкой**: `12 маршрутов · 5 избранных · 28 просмотров`
- Превью избранного/истории: показывать **максимум 4 карточки** (сейчас 8 — слишком много)
- Кнопку «Выйти» перенести в меню разделов как последний пункт (с danger-стилем)
- Добавить кнопку «Редактировать» рядом с аватаром (уже есть, но мелкая)

**Затрагиваемые файлы:** `app/(tabs)/profile.tsx`

---

### 2.5. Фильтры — мобильный UX (P1)

**Текущее состояние:** На `/roulette` фильтры открываются в полноэкранном `Modal`. На `/search` и `/travelsby` фильтры в боковой панели (десктоп) или в `ModernFilters` с кнопкой.

**Проблемы:**
- На мобильном `/search` фильтры занимают много места или скрыты
- Нет визуального индикатора количества активных фильтров на кнопке
- При применении фильтров нет анимации перехода

**Изменения:**
- На мобильном: фильтры в **bottom sheet** (не полноэкранный modal) с drag-to-close
- На кнопке фильтров: **badge с числом** активных фильтров (уже есть `activeFiltersCount` в roulette — распространить)
- При применении: плавная анимация обновления списка (fade)
- Кнопка «Сбросить фильтры» — всегда видна, если есть активные фильтры

**Затрагиваемые файлы:** `components/listTravel/ModernFilters.tsx`, `components/listTravel/SearchAndFilterBar.tsx`, `app/(tabs)/roulette.tsx`

---

### 2.6. Footer (десктоп) — упрощение (P2)

**Текущее состояние:** `FooterDesktop` содержит иконки навигации (дублируют хедер), соцсети, утилитарные ссылки, копирайт. Иконки мелкие (18px), текст 9-10px.

**Проблемы:**
- Дублирование навигации хедера
- Слишком мелкий текст (9px) — проблемы с читаемостью
- Нет визуальной иерархии

**Изменения:**
- Убрать дублирование навигации хедера из футера
- Оставить: **соцсети** (крупнее, 20px иконки) + **утилитарные ссылки** (О сайте, Политика, Cookies) + **копирайт**
- Увеличить минимальный размер текста до 12px
- Добавить разделитель между секциями

**Затрагиваемые файлы:** `components/layout/FooterDesktop.tsx`

---

### 2.7. Cookie consent banner — менее навязчивый (P1)

**Текущее состояние:** Баннер перекрывает нижнюю часть экрана и блокирует клики (исправлено pointer-events, но визуально мешает).

**Изменения:**
- Сделать баннер **компактнее**: одна строка на десктопе, две строки на мобильном
- Кнопки: «Принять» (primary) и «Настроить» (secondary, текстовая ссылка)
- Позиционирование: **снизу**, но с отступом от bottom dock на мобильном
- После принятия: плавное скрытие (slide down)

**Затрагиваемые файлы:** `components/layout/ConsentBanner.tsx`

---

### 2.8. Страница настроек — группировка (P2)

**Текущее состояние:** Настройки — длинная форма с полями профиля, аватаром, темой, соцсетями, действиями (очистка истории/избранного, выход). Всё в одном скролле, 907 строк.

**Изменения:**
- Разбить на **секции с заголовками**: «Профиль», «Внешний вид», «Социальные сети», «Данные», «Аккаунт»
- Каждая секция — collapsible блок (использовать `CollapsibleBlock` из `components/ui/`)
- Кнопка «Сохранить» — **sticky** внизу экрана при наличии несохранённых изменений
- Индикатор несохранённых изменений (уже есть `hasUnsavedChanges` — использовать визуально)

**Затрагиваемые файлы:** `app/(tabs)/settings.tsx`

---

### 2.9. Рулетка — визуальная доработка (P2)

**Текущее состояние:** На десктопе — круговой layout с компасом и 3 карточками. На мобильном — вертикальный список. Есть фоновое изображение карты.

**Проблемы:**
- Круговой layout на десктопе визуально интересен, но карточки мелкие и плохо читаемы
- На мобильном нет визуального «вау-эффекта» — просто список
- Текст «Подбираем маршруты…» — нет анимации

**Изменения:**
- На десктопе: увеличить размер карточек в круговом layout
- На мобильном: добавить **анимацию «вращения»** при подборе (CSS rotation или Animated)
- Заменить текстовый лоадер на **анимированный компас** (rotate animation)
- После подбора: карточки появляются с **stagger-анимацией** (одна за другой)

**Затрагиваемые файлы:** `app/(tabs)/roulette.tsx`, `components/roulette/styles.ts`

---

### 2.10. Страница статей — модернизация (P3)

**Текущее состояние:** Используется `DataTable` из react-native-paper для пагинации. Визуально выглядит как таблица, а не как блог.

**Изменения:**
- Заменить `DataTable.Pagination` на кастомный `PaginationComponent` (уже есть в `components/ui/`)
- Карточки статей — в grid-layout (как путешествия)
- Добавить SEO-мета (сейчас отсутствует на `/articles`)

**Затрагиваемые файлы:** `app/(tabs)/articles.tsx`, `components/article/ArticleListItem.tsx`

---

## 3. Что удалить / убрать

### 3.1. Дублирующие компоненты карточек (P2)

**Удалить/объединить:**
- `TravelCardCompact.tsx` (2971 байт) — заменить на `UnifiedTravelCard` с `layout="compact"`
- `TabTravelCard.tsx` (4172 байт) — заменить на `UnifiedTravelCard` с `layout="grid"` + badge
- `TravelListItem.tsx` (27110 байт) — оставить как основной list-вариант, но унифицировать стили с `UnifiedTravelCard`

**Результат:** 2 компонента вместо 4, единообразный вид карточек

---

### 3.2. Неиспользуемые/устаревшие компоненты (P3)

| Компонент | Размер | Причина удаления |
|---|---|---|
| `components/listTravel/ListTravel.tsx` | 33 КБ | Дублирует `ListTravelBase.tsx` (37 КБ) — проверить, используется ли |
| `components/listTravel/ListTravelOptimized.tsx` | 2 КБ | Обёртка — проверить необходимость |
| `components/listTravel/ListTravelRedesigned.tsx` | 4.7 КБ | «Redesigned» — проверить, не legacy ли |
| `components/listTravel/DesignToggle.tsx` | 6.7 КБ | Toggle между дизайнами — если миграция завершена, удалить |
| `components/places/` | 1 файл | Проверить использование |
| `components/mainPage/` | 1 файл | Проверить использование |
| `components/belkraj/` | 1 файл | Проверить использование |

**Действие:** Проверить импорты каждого файла. Если 0 импортов в prod-коде — удалить.

---

### 3.3. Избыточные стили (P3)

| Файл | Размер | Проблема |
|---|---|---|
| `components/listTravel/enhancedTravelCardStyles.ts` | 23 КБ | Проверить, не дублирует ли `travelListItemStyles.ts` |
| `components/listTravel/listTravelStyles.ts` | 16 КБ | Проверить, используется ли после рефакторинга |
| `components/listTravel/searchAndFilterBarStyles.ts` | 8.8 КБ | Проверить, не inline ли стили в компоненте |

---

### 3.4. Убрать визуальный шум (P1)

- **Убрать `Dimensions.get('window').height`** из стилей логина/регистрации — это фиксирует высоту при первом рендере и ломает layout при повороте экрана. Заменить на `flex: 1` + `justifyContent: 'center'`
- **Убрать inline `opacity: 0.9`** на фоновом изображении логина — делает UI «грязным»
- **Убрать дублирование `queueAnalyticsEvent`** — функция копипастится в `Home.tsx` и `HomeHero.tsx`. Вынести в `utils/analytics.ts`

---

### 3.5. Убрать `react-native-paper` из auth-форм (P2)

**Текущее состояние:** `login.tsx` и `registration.tsx` импортируют `Button` и `Card` из `@/ui/paper`. Остальное приложение использует собственные `components/ui/Button` и стили.

**Изменение:** Заменить `Card` на `View` со стилями (уже есть `card` стиль в `createStyles`). Заменить `Button` из paper на `components/ui/Button`. Это уменьшит зависимость от `react-native-paper`.

**Затрагиваемые файлы:** `app/(tabs)/login.tsx`, `app/(tabs)/registration.tsx`, `app/(tabs)/set-password.tsx`

---

## 4. Приоритизация

### P1 — Критично (влияет на конверсию и первое впечатление)

| # | Задача | Сложность | Влияние |
|---|---|---|---|
| 2.1 | Hero-блок — двойной фокус, мобильное изображение | Средняя | Высокое |
| 2.3 | Login/Registration UX (пароль, сила, divider) | Низкая | Высокое |
| 2.5 | Фильтры — мобильный UX (badge, bottom sheet) | Средняя | Высокое |
| 2.7 | Cookie banner — компактнее | Низкая | Высокое |
| 1.1 | Онбординг для новых пользователей | Средняя | Высокое |
| 1.2 | Empty states с иллюстрациями | Низкая | Среднее |
| 1.3 | Toast-уведомления при действиях | Низкая | Среднее |
| 3.4 | Убрать визуальный шум (opacity, Dimensions) | Низкая | Среднее |

### P2 — Важно (улучшает UX для постоянных пользователей)

| # | Задача | Сложность | Влияние |
|---|---|---|---|
| 2.2 | Карточки — единообразие | Высокая | Высокое |
| 2.4 | Профиль — упрощение | Средняя | Среднее |
| 2.6 | Footer — упрощение | Низкая | Низкое |
| 2.8 | Настройки — группировка | Средняя | Среднее |
| 2.9 | Рулетка — анимации | Средняя | Среднее |
| 1.4 | Индикатор «Вы здесь» в навигации | Низкая | Среднее |
| 1.5 | Скелетоны для всех страниц | Низкая | Среднее |
| 1.8 | Подсказки при пустом поиске | Низкая | Среднее |
| 1.10 | Тёмная тема — переключатель в хедере | Низкая | Низкое |
| 3.5 | Убрать paper из auth-форм | Низкая | Низкое |

### P3 — Nice-to-have (полировка)

| # | Задача | Сложность | Влияние |
|---|---|---|---|
| 2.10 | Статьи — модернизация | Средняя | Низкое |
| 1.6 | Кнопка «Наверх» | Низкая | Низкое |
| 1.7 | Breadcrumbs на внутренних страницах | Низкая | Низкое |
| 1.9 | Анимация избранного | Низкая | Низкое |
| 3.1 | Удалить дублирующие карточки | Средняя | Среднее |
| 3.2 | Удалить неиспользуемые компоненты | Низкая | Низкое |
| 3.3 | Удалить избыточные стили | Низкая | Низкое |

---

## Ограничения

- **Бэкенд не меняется** — все данные берутся из существующих API-эндпоинтов
- **Дизайн-система** — все изменения через `DESIGN_TOKENS` и `useThemedColors()`
- **Иконки** — только `@expo/vector-icons/Feather` (согласно `docs/RULES.md`)
- **Изображения** — нейтральные плейсхолдеры без emoji и текста (согласно `docs/RULES.md`)
- **Тестирование** — каждое изменение должно проходить `yarn lint` + `yarn test:run`

---

*Документ составлен на основе анализа 12 файлов документации, 25+ страниц приложения, 100+ компонентов и QA-отчёта.*
