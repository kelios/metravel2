// Quest data for production migration
// Used by migrate-quests-to-prod.js

module.exports = [
    {
        quest_id: 'krakow-dragon',
        title: 'Тайна Краковского дракона',
        city: { name: 'Kraków', lat: 50.0614, lng: 19.9366, country: 160 },
        meta: { lat: 50.0617, lng: 19.9371, duration_min: 120, difficulty: 'easy', tags: ['legend', 'citywalk', 'history'], pet_friendly: true },
        storage_key: 'quest_krakow_dragon_v1',
        intro: {
            step_id: 'intro', title: 'Как пройти квест?', location: 'Начало приключения',
            story: 'Этот квест — путешествие по Кракову, где оживает легенда о Вавельском драконе.\n\nЧто делать:\n1) Прочитай легенду и задание для каждой точки.\n2) Найди место на карте.\n3) Осмотрись и выполни задание.\n4) Введи ответ — откроется следующий шаг.\n\nПодсказки: подсказывают направление, но не выдают ответ.\n\nФинал: после всех испытаний — встреча с драконом!',
            task: 'Нажми «Начать квест», чтобы отправиться в путь.',
            hint: null, answer: () => true, lat: 0, lng: 0, mapsUrl: '',
        },
        steps: [
            { step_id: '1-rynek', title: 'Рыночная площадь — пробуждение легенды', location: 'Rynek Główny', story: 'Сердце Кракова бьётся здесь. У подножия «Eros Bendato» шепчут о чудовище, что жил под Вавелем. Если заметил голову — смотри на её сторону: там первый след. Эхо мелодии трубача направит дальше — к Мариацкому костёлу.', task: 'Посмотри на Суконные ряды напротив «Eros Bendato». Считай окна над аркадами только со стороны, где стоит голова. Сколько их?', hint: 'Смотри на «свою» половину рядов со стороны головы. Окна идут подряд, высоко.', answer: s => { const n = parseInt(s,10); return !Number.isNaN(n) && n >= 21 && n <= 23; }, lat: 50.061697, lng: 19.937117, mapsUrl: 'https://maps.google.com/?q=Rynek%20G%C5%82%C3%B3wny%20Krak%C3%B3w' },
            { step_id: '2-mariacki', title: 'Мариацкий костёл — оборванная мелодия', location: 'Bazylika Mariacka', story: 'Трубач каждый час поднимал тревогу, но стрела прервала его песнь. С тех пор мелодия всегда обрывается — и повторяется снова и снова. Отзвуки приведут тебя к печати города в Суконных рядах.', task: 'Сколько раз он слышен в течение суток?', hint: 'Подумай о том, сколько раз сменяется часовая стрелка.', answer: s => parseInt(s,10) === 24, lat: 50.061721, lng: 19.939094, mapsUrl: 'https://maps.google.com/?q=St%20Mary%27s%20Basilica%20Krakow' },
            { step_id: '3-sukiennice', title: 'Суконные ряды — печать города', location: 'Sukiennice', story: 'На фасадах и внутри рядов — герб-печать, что веками оберегала город от бед. В её башнях заключена сила. Три стража укажут путь к северной границе — к Флорианским воротам.', task: 'Сколько башен на гербе города? Введи число.', hint: 'Герб можно найти не только снаружи — пройдись внутри вдоль рядов и присмотрись к эмблемам.', answer: s => parseInt(s,10) === 3, lat: 50.061667, lng: 19.937373, mapsUrl: 'https://maps.google.com/?q=Sukiennice%20Krakow' },
            { step_id: '4-barbakan', title: 'Флорианские ворота — страж на рубеже', location: 'Флорианские ворота', story: 'Северный вход города охраняет птица силы. Её барельеф смотрит в сторону Барбака — напоминание о линиях обороны. Найдёшь её — свет в Казимежe подскажет следующий след.', task: 'Найди барельеф над порталом Флорианских ворот. Какая птица охраняет вход со стороны Барбака?', hint: 'Крылья раскинуты, взгляд строгий — символ власти и защиты.', answer: s => s.toLowerCase().replace(/\s+/g,' ').replace(/[.,;:!?'""\u201e\u201c\u201d\u2013\u2014-]/g,'').replace('\u0451','\u0435').trim() === '\u043e\u0440\u0435\u043b', lat: 50.06551229826169, lng: 19.941680331885227, mapsUrl: 'https://maps.google.com/?q=Florian%20Gate%20Krakow' },
            { step_id: '5-kazimierz', title: 'Казимеж — перекрёсток голосов', location: 'Старая синагога', story: 'В этих кварталах легенду рассказывали по-разному, и правду о драконе отражали ночные огни на фасадах. Свет укажет путь к мосту между небом и землёй.', task: 'Сколько источников света освещают этот фасад ночью?', hint: 'Считай отдельные точки света, а не блики.', answer: s => { const n = parseInt(s,10); return !Number.isNaN(n) && n >= 2 && n <= 4; }, lat: 50.05152733785882, lng: 19.94864899181073, mapsUrl: 'https://maps.google.com/?q=Old%20Synagogue%20Krakow' },
            { step_id: '6-wawel', title: 'Мост между небом и землёй', location: 'Мост (см. карту)', story: 'Говорят, этот мост соединяет земное и небесное. Даже здесь чувствуется дыхание легенды — смотри внимательнее: драконьи мотивы продолжают путь к логову.', task: 'Сколько драконов охраняют мост?', hint: 'Осмотрись по торцам и декоративным элементам', answer: s => parseInt(s,10) === 1, lat: 50.046563, lng: 19.947499, mapsUrl: 'https://maps.google.com/?q=50.046563,19.947499' },
            { step_id: '7-smocza-jama', title: 'Smocza Jama — логово чудовища', location: 'Пещера дракона', story: 'Вот она — Smocza Jama. Двигайся именно к входу в пещеру: короткая каменная лестница ведёт прямо к порогу.', task: 'Дойди до входа в пещеру и посчитай ступени, которые ведут до порога. Сколько ступеней до пещеры?', hint: 'Считай только до входа (внутри не нужно). Ответ — двузначное число.', answer: s => parseInt(s,10) === 12, lat: 50.05317524594176, lng: 19.93359915663944, mapsUrl: 'https://maps.google.com/?q=Smocza%20Jama%20Krakow' },
        ],
        finale: { text: 'Ты прошёл путь легенды! Под холмом спал дракон, но его дух не исчез. Он живёт в каждом камне, в шуме Вислы и в сердце Кракова. Пока звучит история — дракон просыпается вновь, напоминая: сила города — в единстве его людей и в их памяти.' },
    },
    {
        quest_id: 'pakocim-voices',
        title: 'Голоса Прокоцина',
        city: { name: 'Kraków – Prokocim', lat: 50.0185, lng: 19.9941, country: 160 },
        meta: { lat: 50.0185, lng: 19.9941, duration_min: 90, difficulty: 'easy', tags: ['park', 'history', 'nature', 'family'], pet_friendly: true },
        storage_key: 'quest_pakocim_v1',
        intro: {
            step_id: 'intro', title: 'Голоса Прокоцина', location: 'Начало пути',
            story: 'Ты держишь в руках невидимую книгу Прокоцина. Каждая её страница — это место: герб, дворец, пруд, дерево, маленький сосед, старые укрепления и тропинка в будущее. Мы будем идти и слушать их голоса. Вопросы простые, но ответить на них можно только здесь — увидев и почувствовав.',
            task: 'Нажми «Начать квест» и отправляйся в прогулку.',
            hint: null, answer: () => true, lat: 0, lng: 0, mapsUrl: '',
        },
        steps: [
            { step_id: '1-herb', title: 'У ворот', location: 'Костёл св. Николая из Толентино', story: 'Сегодня здесь стоит костёл святого Николая из Толентино. Но раньше на этом месте находилась усадьба рода Ержмановских. Их память хранит каменный герб Dołęga. По преданию, его история уходит в XIV век. В битве один из рыцарей пустил стрелу так метко, что она пробила подкову врага. Это сочли чудом и знаком небесной поддержки. С тех пор подкова стала символом защиты и удачи, а знак, проходящий сквозь неё, — напоминанием о воинской доблести. Посмотри внимательно на герб у костёла — в центре ты увидишь этот древний символ.', task: 'Что проходит сквозь подкову на гербе Ержмановских?', hint: 'Это оружие, лёгкое и быстрое, но смертельно точное.', answer: s => ['стрела','strzala','arrow'].includes(s), lat: 50.018536, lng: 19.994134, mapsUrl: 'https://maps.google.com/?q=50.018536,19.994134' },
            { step_id: '2-palace', title: 'Сердце усадьбы', location: 'Дворец', story: 'Перед тобой дворец, переживший смену эпох. Когда-то здесь принимали князя Юзефа Понятовского, позже Эразм Ержмановский превратил его в современную резиденцию с оранжереями и редкими растениями. Но первым хозяином был человек, чьё имя сохранилось на табличке.', task: 'Назови имя первого владельца дворца.', hint: 'Его звали Michał …', answer: s => s === 'michal wodzicki', lat: 50.019348, lng: 19.995399, mapsUrl: 'https://maps.google.com/?q=50.019348,19.995399' },
            { step_id: '3-pond', title: 'Живая вода', location: 'Пруд', story: 'В XIX веке усадебные пруды были местом прогулок и встреч. Сегодня здесь по-прежнему плавают птицы, словно напоминая: жизнь продолжается, несмотря на смену хозяев.', task: 'Сколько уток ты видишь в пруду?', hint: 'Ответ меняется в зависимости от дня.', answer: s => !Number.isNaN(parseInt(s,10)), lat: 50.020948, lng: 20.004057, mapsUrl: 'https://maps.google.com/?q=50.020948,20.004057' },
            { step_id: '4-oak', title: 'Страж времени', location: 'Старое дерево', story: 'В аллее возвышается исполин. Его ствол испещрён глубокими трещинами, а крона раскинулась, как зелёный шатёр.', task: 'Какое дерево стоит здесь?', hint: 'Символ силы и долголетия в славянских традициях.', answer: s => s === 'дуб', lat: 50.017682, lng: 20.012507, mapsUrl: 'https://maps.google.com/?q=50.017682,20.012507' },
            { step_id: '5-hedgehog', title: 'Маленький сосед', location: 'Зона «Jeż na swoim»', story: 'Парк заботится не только о деревьях, но и о самых маленьких. Здесь установлены укрытия и таблички для ночного жителя, который умеет сворачиваться в клубок.', task: 'Кто обитает в этом месте?', hint: 'Колючий герой народных сказок.', answer: s => ['еж','ёж','jez'].includes(s), lat: 50.013842, lng: 20.01445, mapsUrl: 'https://maps.google.com/?q=50.013842,20.01445' },
            { step_id: '6-birdhouses', title: 'Хор парка', location: 'Скворечники и качели', story: 'В этом уголке парка соединяются два голоса — человеческий и птичий. Сядь на качели и дай себе несколько мгновений, чтобы почувствовать, как воздух играет в листьях.', task: 'Сколько скворечников видно с качелей?', hint: 'Считай отдельные домики для птиц, даже если они прячутся в листве.', answer: s => { const n = parseInt(s,10); return !Number.isNaN(n) && n>=0 && n<=20; }, lat: 50.013073, lng: 20.014758, mapsUrl: 'https://maps.google.com/?q=50.013073,20.014758' },
            { step_id: '7-slona-woda', title: 'Солёная вода', location: 'Заказник', story: 'Место с необычным названием — «Słona Woda». Легенда говорит, что вода здесь когда-то имела солёный привкус. Сегодня это охраняемая территория.', task: 'Какова площадь заказника в гектарах?', hint: 'Число можно найти на информационном щите.', answer: s => Math.abs(parseFloat(s.replace(',','.')) - 13.53) < 0.01, lat: 50.005839, lng: 20.000021, mapsUrl: 'https://maps.google.com/?q=50.005839,20.000021' },
            { step_id: '8-fort', title: 'Каменные стены', location: 'Форт Прокоцим', story: 'В XIX веке Краков окружили австрийские укрепления. Этот форт — один из них.', task: 'Найди знак или надпись на стене и опиши её одним словом.', hint: 'Смотри в камне, на табличках или железных элементах.', answer: s => typeof s === 'string' && s.trim().length>0, lat: 50.010556, lng: 19.997223, mapsUrl: 'https://maps.google.com/?q=50.010556,19.997223' },
            { step_id: '9-bridge', title: 'Переход', location: 'Мост через ручей', story: 'Маленький переход через поток соединяет две тропы. Он сделан из простого материала, знакомого каждому.', task: 'Из какого материала сделан настил моста?', hint: 'Посмотри под ноги.', answer: s => ['дерево','деревянный','drewniany'].includes(s), lat: 50.015474, lng: 19.991301, mapsUrl: 'https://maps.google.com/?q=50.015474,19.991301' },
            { step_id: 'bonus-cafe', title: 'Сладкая пауза', location: 'Кавярня у парка', story: 'Иногда история проявляется не только в камне или деревьях, а и в простых радостях. По субботам и воскресеньям хозяйка открывает двери маленькой кавярни.', task: 'Никаких загадок — просто сделай паузу и насладись моментом.', hint: null, answer: () => true, lat: 50.018982, lng: 19.994333, mapsUrl: 'https://maps.google.com/?q=50.018982,19.994333' },
        ],
        finale: { text: 'Ты собрал все голоса Прокоцима в единую симфонию! От древнего герба со стрелой, пронзившей время, до каменных стен форта, хранящего шепот солдат... От векового дуба-исполина до маленького ежа, что сворачивается в клубок под защитой парка...\n\nНо самое главное — теперь ты стал частью этой истории. Твои шаги по мосту через ручей — это не просто переход, а символический жест: ты принял эстафету от тех, кто ходил этими тропами до тебя.\n\nПрокоцим продолжает жить и меняться, и теперь ты — один из его голосов.\n\nСпасибо, что прошел этот путь до конца!' },
    },
    {
        quest_id: 'barkovshchina-spirits',
        title: 'Хранитель тайн Барковщины',
        city: { name: 'Тайны Барковщинского леса', lat: 55.101231, lng: 28.603838, country: 3 },
        meta: { lat: 55.101231, lng: 28.603838, duration_min: 60, difficulty: 'easy', tags: ['nature', 'forest', 'lake', 'legend'], pet_friendly: true },
        storage_key: 'quest_barkov_forest_secrets_v1',
        intro: {
            step_id: 'intro', title: 'Начало лесного приключения', location: 'Вход в заповедный лес',
            story: 'Добро пожаловать в таинственный лес Барковщины! Говорят, в этих местах обитают древние духи природы, которые оставили свои следы для тех, кто умеет видеть и слышать. Тебе предстоит пройти по трём загадочным точкам, выполнить задания лесных духов и раскрыть секреты этого волшебного места.',
            task: 'Осмотрись вокруг, вдохни лесной воздух и нажми "Начать квест", когда будешь готов отправиться в путь.',
            hint: null, answer: () => true, lat: 55.101231, lng: 28.603838, mapsUrl: 'https://maps.google.com/maps?q=55.101231,28.603838',
        },
        steps: [
            { step_id: 'point-1', title: 'Родник Барковщина', location: 'Святой источник у деревни Барковщина', story: 'Этот источник называют сердцем Барковщинского леса. Легенда гласит, что когда-то здесь упал жезл старого мудреца. Из земли в том месте забил чистый ключ, который с тех пор никогда не пересыхает.', task: 'Посчитай, сколько источников выходит здесь на поверхность? (Введи число)', hint: 'Прислушайся к журчанию — не один голос слышен у воды.', answer: s => parseInt(s,10) === 4, lat: 55.101231, lng: 28.603838, mapsUrl: 'https://maps.google.com/maps?q=55.101231,28.603838', inputType: 'number' },
            { step_id: 'point-1-2', title: 'Тайна родника', location: 'Тот же святой источник', story: 'Говорят, у родника часто можно увидеть камни, покрытые мхом. Это знак древних духов воды.', task: 'Найди камень со мхом и посчитай, сколько разных сортов мха на нём?', hint: 'Вглядись внимательнее: один камень может хранить в себе маленький зелёный лес.', answer: s => { const n = parseInt(s,10); return Number.isInteger(n) && n >= 1 && n <= 20; }, lat: 55.101231, lng: 28.603838, mapsUrl: 'https://maps.google.com/maps?q=55.101231,28.603838', inputType: 'number' },
            { step_id: 'point-2', title: 'Шепчущие сосны', location: 'Роща вековых сосен', story: 'Ты попал в священную рощу, где деревья помнят каждую легенду этих мест.', task: 'Сколько разных птичьих голосов ты слышишь в этой роще? (Введи число)', hint: 'Закрой глаза на минуту и сосредоточься только на звуках.', answer: s => { const n = parseInt(s,10); return Number.isInteger(n) && n >= 1 && n <= 6; }, lat: 55.112393, lng: 28.603036, mapsUrl: 'https://maps.google.com/maps?q=55.112393,28.603036', inputType: 'number' },
            { step_id: 'point-2-2', title: 'Язык ветра', location: 'Все та же роща сосен', story: 'Ветер здесь играет особую мелодию. Он проходит через хвою и создает уникальную музыку леса.', task: 'Какое настроение у этого места? Опиши одним словом.', hint: 'Прислушайся к своим ощущениям. Спокойствие, таинственность, радость, грусть?', answer: s => s.length > 2, lat: 55.112393, lng: 28.603036, mapsUrl: 'https://maps.google.com/maps?q=55.112393,28.603036' },
            { step_id: 'point-3', title: 'Озеро отражений', location: 'Лесное озеро у тропы', story: 'Перед тобой открывается зеркальная гладь лесного озера.', task: 'Сколько уток плавает на озере?', hint: 'Внимательно посмотри на водную поверхность. Если уток нет, введи 0.', answer: s => s.length > 0, lat: 55.119597, lng: 28.605857, mapsUrl: 'https://maps.google.com/maps?q=55.119597,28.605857' },
            { step_id: 'point-3-2', title: 'Тайна водной глади', location: 'Все то же лесное озеро', story: 'Присмотрись к отражению в воде.', task: 'Опиши цвет воды в озере одним словом.', hint: 'Цвет может меняться в зависимости от погоды и времени дня.', answer: s => s.length > 2, lat: 55.119597, lng: 28.605857, mapsUrl: 'https://maps.google.com/maps?q=55.119597,28.605857' },
        ],
        finale: { text: 'Мы видели твой путь, путник. У родника ты услышал голоса воды, у сосен — шёпот ветра, у озера — отражение души. Ты был внимателен и честен, и потому лес открыл тебе свои тайны. Теперь мы знаем твоё имя и будем хранить твои шаги, куда бы ты ни направился. Возвращайся, когда сердце захочет — Барковщина всегда встретит тебя, как старого друга.' },
    },
    {
        quest_id: 'minsk-cmok',
        title: 'Тайна Свислочского Цмока: Легенда оживает',
        city: { name: 'Минск', lat: 53.9023, lng: 27.5619, country: 3 },
        meta: { lat: 53.9045, lng: 27.5615, duration_min: 45, difficulty: 'easy', tags: ['citywalk', 'myth'], pet_friendly: false },
        storage_key: 'quest_minsk_smok_awakened_v3',
        intro: {
            step_id: 'intro', title: 'Тайна Свислочского Цмока', location: 'Начало пути',
            story: '**Старинная белорусская легенда гласит:**\n\nВ водах Свислочи испокон веков жил могучий Цмок — дух-хранитель этих земель.\n\nКогда-то его дочь, прекрасная река Свислочь, влюбилась в человека по имени Менеск.\nЦмок даровал им благословение, и так возник город Минск.\n\n**Твоя миссия:**\nПройди по семи сакральным точкам города, собери древние артефакты-воспоминания и разбуди Цмока от многовекового сна!',
            task: 'Найди первую точку у входа в Парк Горького и нажми "Начать квест"',
            hint: null, answer: () => true, lat: 53.9039, lng: 27.5719, mapsUrl: 'https://maps.google.com/?q=53.9039,27.5719',
        },
        steps: [
            { step_id: '1-forest-memory', title: 'Артефакт Леса', location: 'Главный вход в Парк Горького', story: 'Здесь начинался древний лес, где Цмок встречался с духами природы.', task: 'В каком году был основан Губернаторский сад (ныне Парк Горького)? (год)', hint: 'Подсказка: начало XIX века', answer: s => parseInt(s,10) === 1805, lat: 53.9039, lng: 27.5719, mapsUrl: 'https://maps.google.com/?q=53.9039,27.5719', inputType: 'number' },
            { step_id: '2-sun-memory', title: 'Артефакт Солнца', location: 'Колесо обозрения', story: 'Цмок часто принимал форму солнечного зайчика, играющего на волнах Свислочи.', task: 'Сколько полных метров в высоту колесо обозрения? (цифра)', hint: 'Подсказка: примерно как 18-этажный дом', answer: s => parseInt(s,10) === 54, lat: 53.9034, lng: 27.5744, mapsUrl: 'https://maps.google.com/?q=53.9034,27.5744', inputType: 'number' },
            { step_id: '3-star-memory', title: 'Артефакт Звёзд', location: 'Минский планетарий', story: 'По ночам Цмок превращался в созвездие и купался в водах Свислочи, отражающей звёзды.', task: 'В каком году открылся планетарий? (год)', hint: 'Подсказка: эпоха космонавтики, 1960-е', answer: s => parseInt(s,10) === 1965, lat: 53.9045, lng: 27.5745, mapsUrl: 'https://maps.google.com/?q=53.9045,27.5745', inputType: 'number' },
            { step_id: '4-voice-memory', title: 'Артефакт Голоса', location: 'Большой театр оперы и балета', story: 'Голос Цмока был подобен самой прекрасной музыке.', task: 'В каком году состоялась первая премьера в театре («Кармен»)? (год)', hint: 'Подсказка: 1930-е годы', answer: s => parseInt(s,10) === 1933, lat: 53.9104, lng: 27.5617, mapsUrl: 'https://maps.google.com/?q=53.9104,27.5617', inputType: 'number' },
            { step_id: '5-memory-memory', title: 'Артефакт Памяти', location: 'Остров слёз', story: 'Цмок плакал слезами из чистого хрусталя, когда терял тех, кого защищал.', task: 'В каком году открыли мемориал? (год)', hint: 'Подсказка: 1990-е, после Афганской войны', answer: s => parseInt(s,10) === 1996, lat: 53.9072, lng: 27.5585, mapsUrl: 'https://maps.google.com/?q=53.9072,27.5585', inputType: 'number' },
            { step_id: '6-word-memory', title: 'Артефакт Слова', location: 'Троицкое предместье, памятная скамейка', story: 'Цмок вдохновлял поэтов через шепот Свислочи. Найдите скамейку, где запечатлены строки того, кто слышал голос речного духа.', task: 'Какое слово повторяется в первой и последней строке стихотворения на скамейке?', hint: 'Подсказка: связано с тем, что течёт и имеет голос', answer: s => ['рака','ракі','река','реки'].includes(s), lat: 53.9079, lng: 27.5575, mapsUrl: 'https://maps.google.com/?q=53.9079,27.5575' },
            { step_id: '7-water-memory', title: 'Последний артефакт', location: 'Набережная Свислочи у Троицкого', story: 'Теперь у тебя есть все артефакты! Лес, Солнце, Звёзды, Голос, Память и Слово.\n\nВыйди на набережную, встань лицом к воде и произнеси:\n"Цмок Свислочский, я принёс тебе воспоминания твоего города!"', task: 'Какое настоящее имя Цмока из древних легенд? (подсказка: ищи на информационных щитах)', hint: 'Подсказка: два слова: «Свислочский …» / «Свіслацкі …»', answer: s => ['свислочский цмок','цмок свислочский','свіслацкі цмок','цмок свіслацкі'].includes(s), lat: 53.9080, lng: 27.5570, mapsUrl: 'https://maps.google.com/?q=53.9080,27.5570' },
        ],
        finale: { text: '**Воды Свислочи вдруг забурлили, и из глубины поднялся величественный Цмок!**\n\n*"Благодарю тебя, хранитель памяти. Ты вернул мне силу, собрав артефакты воспоминаний."*\n\n*"Пока живёт память — жив город. Пока течёт Свислочь — жив я."*\n\n*"Расскажи другим эту легенду, чтобы не забывали..."*\n\nЦмок медленно погружается обратно в воды, но теперь ты знаешь — он бодрствует и защищает город.\n\n**Квест завершён! Ты разбудил хранителя Минска!**' },
    },
];
