# Тест-кейсы: Страница путешествий по Беларуси (/travelsby)

## Общая информация
- **Страница**: Путешествия по Беларуси
- **URL**: `/travelsby`
- **Компонент**: `app/(tabs)/travelsby.tsx`
- **Приоритет**: P1 (Critical)

---

## TC-TRAVELSBY-001: Загрузка страницы со списком путешествий
**Приоритет**: P1  
**Предусловия**: API доступен, в базе есть путешествия

### Шаги:
1. Открыть URL `/travelsby`
2. Дождаться загрузки списка

### Ожидаемый результат:
- Страница загружается без ошибок
- Отображается список путешествий
- Видны фильтры поиска
- API запрос к `/api/travels/` выполнен успешно

### Проверки:
- [ ] Страница отображается
- [ ] Список путешествий загружен
- [ ] Фильтры видны
- [ ] Нет ошибок в консоли

---

## TC-TRAVELSBY-002: Фильтрация по стране (Беларусь по умолчанию)
**Приоритет**: P1  
**Предусловия**: Открыта страница /travelsby

### Шаги:
1. Проверить, что фильтр "Беларусь" активен по умолчанию
2. Проверить, что отображаются только путешествия по Беларуси

### Ожидаемый результат:
- По умолчанию выбрана Беларусь
- В списке только путешествия по Беларуси
- URL параметр может содержать: `?countries=[112]` (ID Беларуси)

### Проверки:
- [ ] Фильтр Беларусь активен
- [ ] Карточки содержат только Беларусь
- [ ] API запрос включает фильтр по стране

---

## TC-TRAVELSBY-003: Открытие и применение фильтров
**Приоритет**: P1  
**Предусловия**: Страница загружена

### Шаги:
1. Кликнуть на кнопку "Фильтры" или иконку фильтров
2. Открыть модальное окно с фильтрами
3. Выбрать параметры:
   - Категория (например, "Природа")
   - Сложность (например, "Легкий")
   - Транспорт (например, "Автомобиль")
4. Применить фильтры

### Ожидаемый результат:
- Модальное окно фильтров открывается
- Все фильтры доступны для выбора
- После применения список обновляется
- URL обновляется с параметрами фильтров
- API запрос отправляется с новыми параметрами

### Проверки:
- [ ] Модальное окно открывается
- [ ] Фильтры применяются
- [ ] Список обновляется
- [ ] URL содержит параметры

---

## TC-TRAVELSBY-004: Очистка всех фильтров
**Приоритет**: P2  
**Предусловия**: Применены фильтры

### Шаги:
1. Применить несколько фильтров
2. Найти кнопку "Очистить все" или "Сбросить"
3. Кликнуть на кнопку

### Ожидаемый результат:
- Все фильтры сбрасываются
- Список возвращается к состоянию по умолчанию (только Беларусь)
- URL очищается от параметров фильтров

### Проверки:
- [ ] Фильтры сброшены
- [ ] Список обновлен
- [ ] URL обновлен

---

## TC-TRAVELSBY-005: Пагинация списка
**Приоритет**: P1  
**Предусловия**: В базе больше 10-20 путешествий

### Шаги:
1. Прокрутить список до конца
2. Проверить загрузку следующей страницы (infinite scroll или кнопка "Загрузить еще")
3. Проверить отсутствие дубликатов

### Ожидаемый результат:
- При прокрутке загружаются новые элементы
- API запрос: `/api/travels/?page=2&perPage=20`
- Нет дублирующихся карточек
- Индикатор загрузки отображается

### Проверки:
- [ ] Пагинация работает
- [ ] Новые элементы добавляются
- [ ] Нет дубликатов
- [ ] Scroll position стабильна

---

## TC-TRAVELSBY-006: Клик по карточке путешествия
**Приоритет**: P1  
**Предусловия**: Список загружен

### Шаги:
1. Найти карточку путешествия в списке
2. Кликнуть на карточку

### Ожидаемый результат:
- Переход на детальную страницу путешествия
- URL формата: `/travel/[slug]` или `/travels/[id]`
- Страница загружается без ошибок

### Проверки:
- [ ] Клик работает
- [ ] Переход выполнен
- [ ] Детальная страница открылась

---

## TC-TRAVELSBY-007: Отображение информации в карточке
**Приоритет**: P2  
**Предусловия**: Список загружен

### Шаги:
1. Проверить содержимое карточки путешествия

### Ожидаемый результат:
Карточка содержит:
- Изображение (thumbnail)
- Название путешествия
- Страна
- Количество просмотров
- Автор путешествия (userName)

### Проверки:
- [ ] Изображение загружается
- [ ] Название отображается
- [ ] Данные корректны
- [ ] Layout не сломан

---

## TC-TRAVELSBY-008: Добавление в избранное из списка
**Приоритет**: P2  
**Предусловия**: Пользователь авторизован

### Шаги:
1. Найти иконку "Избранное" (сердечко) на карточке
2. Кликнуть на иконку
3. Проверить изменение состояния

### Ожидаемый результат:
- Иконка меняет цвет/состояние
- API запрос: `PATCH /api/travels/{id}/mark-as-favorite/`
- Путешествие появляется в разделе "Избранное"

### Проверки:
- [ ] Иконка изменилась
- [ ] API запрос успешен
- [ ] Feedback пользователю (toast/анимация)

---

## TC-TRAVELSBY-009: Попытка добавить в избранное без авторизации
**Приоритет**: P2  
**Предусловия**: Пользователь НЕ авторизован

### Шаги:
1. Кликнуть на иконку "Избранное"
2. Наблюдать реакцию системы

### Ожидаемый результат:
- Появляется модальное окно или редирект на /login
- Сообщение: "Войдите, чтобы добавить в избранное"
- Действие не выполняется

### Проверки:
- [ ] Модальное окно/редирект
- [ ] Понятное сообщение
- [ ] Путешествие не добавлено

---

## TC-TRAVELSBY-010: Поиск по названию путешествия
**Приоритет**: P2  
**Предусловия**: На странице есть поле поиска

### Шаги:
1. Найти поле поиска
2. Ввести название путешествия (например, "Минск")
3. Нажать Enter или кнопку поиска

### Ожидаемый результат:
- Список фильтруется по введенному запросу
- Отображаются только соответствующие результаты
- API запрос с параметром `?search=минск` или `?q=минск`

### Проверки:
- [ ] Поиск работает
- [ ] Результаты релевантны
- [ ] Нет результатов → показывается заглушка

---

## TC-TRAVELSBY-011: Отображение пустого состояния
**Приоритет**: P2  
**Предусловия**: Применены фильтры, но нет результатов

### Шаги:
1. Применить фильтры, которые не дают результатов
2. Проверить отображение

### Ожидаемый результат:
- Отображается сообщение "Путешествия не найдены"
- Есть кнопка "Очистить фильтры"
- Нет ошибок в консоли

### Проверки:
- [ ] Empty state отображается
- [ ] Сообщение понятное
- [ ] Есть action button

---

## TC-TRAVELSBY-012: Фильтр по категориям
**Приоритет**: P1  
**Предусловия**: Есть различные категории путешествий

### Шаги:
1. Открыть фильтры
2. Выбрать категорию (например, "Замки и крепости")
3. Применить

### Ожидаемый результат:
- Список обновляется
- Отображаются только путешествия выбранной категории
- API запрос: `?categories=[id]`

### Проверки:
- [ ] Фильтр применяется
- [ ] Результаты корректны
- [ ] Счетчик фильтров обновлен

---

## TC-TRAVELSBY-013: Фильтр по сложности
**Приоритет**: P2  
**Предусловия**: Фильтры доступны

### Шаги:
1. Открыть фильтры
2. Выбрать сложность (Легкий/Средний/Сложный)
3. Применить

### Ожидаемый результат:
- Список фильтруется по сложности
- API параметр: `?complexity=[id]`

### Проверки:
- [ ] Фильтр работает
- [ ] Результаты соответствуют

---

## TC-TRAVELSBY-014: Фильтр по типу транспорта
**Приоритет**: P2  
**Предусловия**: Фильтры доступны

### Шаги:
1. Открыть фильтры
2. Выбрать транспорт (Автомобиль/Велосипед/Пешком)
3. Применить

### Ожидаемый результат:
- Список обновляется согласно выбранному транспорту
- API параметр: `?transports=[id]`

### Проверки:
- [ ] Фильтр применен
- [ ] Результаты корректны

---

## TC-TRAVELSBY-015: Фильтр по количеству ночевок
**Приоритет**: P3  
**Предусловия**: Фильтры доступны

### Шаги:
1. Открыть фильтры
2. Выбрать количество ночевок (1-2 / 3-5 / 6+)
3. Применить

### Ожидаемый результат:
- Список фильтруется
- API параметр: `?over_nights_stay=[id]`

### Проверки:
- [ ] Фильтр работает
- [ ] Результаты соответствуют

---

## TC-TRAVELSBY-016: Мобильная версия списка
**Приоритет**: P1  
**Предусловия**: Мобильный viewport

### Шаги:
1. Открыть /travelsby на мобильном устройстве
2. Проверить адаптивность

### Ожидаемый результат:
- Карточки в одну колонку
- Фильтры доступны через модальное окно
- Нижнее меню работает
- Нет горизонтальной прокрутки

### Проверки:
- [ ] Layout адаптирован
- [ ] Фильтры доступны
- [ ] Навигация работает

---

## TC-TRAVELSBY-017: SEO метатеги страницы
**Приоритет**: P2  
**Предусловия**: Доступ к исходному коду

### Шаги:
1. Открыть /travelsby
2. Проверить исходный код

### Ожидаемый результат:
```html
<title>Путешествия по Беларуси | Metravel</title>
<meta name="description" content="Подборка маршрутов и мест по Беларуси..." />
<link rel="canonical" href="https://metravel.by/travelsby" />
```

### Проверки:
- [ ] Title корректен
- [ ] Description заполнен
- [ ] Canonical правильный

---

## TC-TRAVELSBY-018: Deep link с фильтрами
**Приоритет**: P2  
**Предусловия**: URL с параметрами фильтров

### Шаги:
1. Открыть URL с параметрами: `/travelsby?categories=[1,2]&complexity=[3]`
2. Проверить применение фильтров

### Ожидаемый результат:
- Фильтры применяются автоматически из URL
- Список отображает отфильтрованные результаты
- Состояние фильтров в UI соответствует URL

### Проверки:
- [ ] Фильтры из URL применены
- [ ] Результаты корректны
- [ ] UI синхронизирован с URL

---

## TC-TRAVELSBY-019: Сохранение состояния при навигации
**Приоритет**: P2  
**Предусловия**: Применены фильтры, открыта детальная страница

### Шаги:
1. Применить фильтры
2. Кликнуть на путешествие
3. Вернуться назад (Browser Back)

### Ожидаемый результат:
- Фильтры остаются примененными
- Scroll position восстанавливается (опционально)
- Список не перезагружается

### Проверки:
- [ ] Фильтры сохранены
- [ ] Состояние восстановлено
- [ ] Нет лишних API запросов

---

## TC-TRAVELSBY-020: Обработка ошибки загрузки списка
**Приоритет**: P1  
**Предусловия**: API недоступен

### Шаги:
1. Имитировать ошибку API (Network offline)
2. Открыть /travelsby

### Ожидаемый результат:
- Отображается сообщение об ошибке
- Есть кнопка "Повторить попытку"
- Нет crash приложения

### Проверки:
- [ ] Error state отображается
- [ ] Retry работает
- [ ] Graceful degradation

---

## Покрытие автоматизацией

### Jest unit tests:
- Рендеринг компонента ListTravel
- Логика фильтрации
- Обработка ошибок

### Playwright E2E:
- `e2e/travelsby-page.spec.ts`
- Фильтры и поиск
- Пагинация

### Связанные файлы:
- `app/(tabs)/travelsby.tsx`
- `components/listTravel/ListTravelBase.tsx`
- `components/listTravel/ModernFilters.tsx`
- `__tests__/components/listTravel/`
