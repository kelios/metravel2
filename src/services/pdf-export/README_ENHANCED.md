# –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ PDF

## –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ PDF —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º –¥–∏–∑–∞–π–Ω–æ–º, –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ 4 –Ω–æ–≤—ã–º–∏ —Ç–µ–º–∞–º–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è.

## –û—Å–Ω–æ–≤–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –°–∏—Å—Ç–µ–º–∞ —Ç–µ–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è

–°–æ–∑–¥–∞–Ω—ã 4 –Ω–æ–≤—ã–µ —Ç–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è:

- **minimal** - –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è: —á–∏—Å—Ç–æ–µ –∏ –ø—Ä–æ—Å—Ç–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç
- **light** - –°–≤–µ—Ç–ª–∞—è: –º–Ω–æ–≥–æ –≤–æ–∑–¥—É—Ö–∞, –º—è–≥–∫–∏–µ —Ü–≤–µ—Ç–∞, –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–µ —á—Ç–µ–Ω–∏–µ
- **dark** - –¢–µ–º–Ω–∞—è: —Ç–µ–º–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ, –ø—Ä–∏–≥–æ–¥–Ω–æ–µ –¥–ª—è –ø–µ—á–∞—Ç–∏ –∏ —ç–∫—Ä–∞–Ω–∞
- **travel-magazine** - Travel Magazine: –∂—É—Ä–Ω–∞–ª—å–Ω–∞—è –≤—ë—Ä—Å—Ç–∫–∞ —Å —è—Ä–∫–∏–º–∏ –∞–∫—Ü–µ–Ω—Ç–∞–º–∏

–ö–∞–∂–¥–∞—è —Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç:
- –ü–æ–ª–Ω—É—é —Ü–≤–µ—Ç–æ–≤—É—é –ø–∞–ª–∏—Ç—Ä—É (—Ç–µ–∫—Å—Ç, —Ñ–æ–Ω, –∞–∫—Ü–µ–Ω—Ç—ã, —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏)
- –¢–∏–ø–æ–≥—Ä–∞—Ñ–∏–∫—É (—à—Ä–∏—Ñ—Ç—ã –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏ —Ç–µ–∫—Å—Ç–∞, —Ä–∞–∑–º–µ—Ä—ã)
- –û—Ç—Å—Ç—É–ø—ã –∏ —Å–µ—Ç–∫—É
- –°—Ç–∏–ª–∏ –±–ª–æ–∫–æ–≤ (—Å–∫—Ä—É–≥–ª–µ–Ω–∏—è, —Ç–µ–Ω–∏, –≥—Ä–∞–Ω–∏—Ü—ã)

### 2. –ü–∞—Ä—Å–µ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞

–°–æ–∑–¥–∞–Ω `ContentParser`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç HTML/Markdown –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏:

- –ó–∞–≥–æ–ª–æ–≤–∫–∏ (h1-h6)
- –ü–∞—Ä–∞–≥—Ä–∞—Ñ—ã
- –°–ø–∏—Å–∫–∏ (—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–µ –∏ –Ω–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–µ)
- –¶–∏—Ç–∞—Ç—ã
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (—Å –ø–æ–¥–ø–∏—Å—è–º–∏)
- –ì–∞–ª–µ—Ä–µ–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏ (–°–æ–≤–µ—Ç, –í–∞–∂–Ω–æ, –õ–∞–π—Ñ—Ö–∞–∫, –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ)
- –ö–æ–¥
- –¢–∞–±–ª–∏—Ü—ã
- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏

### 3. –†–µ–Ω–¥–µ—Ä–µ—Ä –±–ª–æ–∫–æ–≤

`BlockRenderer` —Ä–µ–Ω–¥–µ—Ä–∏—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏ –≤ HTML —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Ç–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è:

- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π —Ç–µ–º—ã
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –±–ª–æ–∫–æ–≤ —Å –∏–∫–æ–Ω–∫–∞–º–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å fallback
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≥–∞–ª–µ—Ä–µ–π

### 4. –£–ª—É—á—à–µ–Ω–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä

`EnhancedPdfGenerator` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç PDF —Å:

- –¢–∏—Ç—É–ª—å–Ω—ã–º –ª–∏—Å—Ç–æ–º
- –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ–º (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –°—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π —Å —Ñ–æ—Ç–æ
- –°—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ —Å –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º (–ø–∞—Ä—Å–∏–Ω–≥ HTML –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏)
- –ì–∞–ª–µ—Ä–µ—è–º–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ö–∞—Ä—Ç–∞–º–∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –§–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π

### 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫—Ä–∞–µ–≤—ã—Ö —Å–ª—É—á–∞–µ–≤

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞:

- –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–π –±–µ–∑ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–π –±–µ–∑ –∫–∞—Ä—Ç—ã
- –û—á–µ–Ω—å –¥–ª–∏–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
- –î–ª–∏–Ω–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- –ü–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü (page-break-inside: avoid –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –±–ª–æ–∫–æ–≤)
- –ó–∞—â–∏—Ç–∞ –æ—Ç "–≤–∏—Å—è—á–∏—Ö" —Å—Ç—Ä–æ–∫ (orphans/widows)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
PdfExportService
  ‚îú‚îÄ‚îÄ TravelDataTransformer (—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö)
  ‚îú‚îÄ‚îÄ EnhancedPdfGenerator (–Ω–æ–≤—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–µ–º)
  ‚îÇ   ‚îú‚îÄ‚îÄ ContentParser (–ø–∞—Ä—Å–∏–Ω–≥ HTML –≤ –±–ª–æ–∫–∏)
  ‚îÇ   ‚îú‚îÄ‚îÄ BlockRenderer (—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –±–ª–æ–∫–æ–≤)
  ‚îÇ   ‚îî‚îÄ‚îÄ PdfThemeConfig (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ–º)
  ‚îî‚îÄ‚îÄ Html2PdfRenderer (—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤ PDF)
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```typescript
import { PdfExportService } from '@/src/services/pdf-export/PdfExportService';
import { Html2PdfRenderer } from '@/src/renderers/pdf/Html2PdfRenderer';
import type { BookSettings } from '@/components/export/BookSettingsModal';

const renderer = new Html2PdfRenderer();
const service = new PdfExportService(renderer);

const settings: BookSettings = {
  title: '–ú–æ–∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è',
  template: 'minimal', // –∏–ª–∏ 'light', 'dark', 'travel-magazine'
  // ... –¥—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
};

const result = await service.export(travels, settings);
```

### –í—ã–±–æ—Ä —Ç–µ–º—ã

–¢–µ–º—ã –≤—ã–±–∏—Ä–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `template` –≤ `BookSettings`:

- `'minimal'` - –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è
- `'light'` - –°–≤–µ—Ç–ª–∞—è
- `'dark'` - –¢–µ–º–Ω–∞—è
- `'travel-magazine'` - Travel Magazine

–°—Ç–∞—Ä—ã–µ —Ç–µ–º—ã (`'classic'`, `'modern'`, `'romantic'`, `'adventure'`) –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ —Å—Ç–∞—Ä—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä.

## –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏ –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ

–ü–∞—Ä—Å–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏ –ø–æ –∫–ª–∞—Å—Å–∞–º:

- `.tip`, `.—Å–æ–≤–µ—Ç`, `.–ª–∞–π—Ñ—Ö–∞–∫` ‚Üí –ë–ª–æ–∫ —Å–æ–≤–µ—Ç–∞ (üí°)
- `.warning`, `.–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ`, `.–≤–∞–∂–Ω–æ` ‚Üí –ë–ª–æ–∫ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (‚ö†Ô∏è)
- `.danger`, `.–æ–ø–∞—Å–Ω–æ—Å—Ç—å` ‚Üí –ë–ª–æ–∫ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (üö®)
- `.info`, `.–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è` ‚Üí –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –±–ª–æ–∫ (‚ÑπÔ∏è)

–ü—Ä–∏–º–µ—Ä HTML:

```html
<div class="tip">
  <strong>–°–æ–≤–µ—Ç:</strong>
  –ù–µ –∑–∞–±—É–¥—å—Ç–µ –≤–∑—è—Ç—å —Å —Å–æ–±–æ–π –ø–∞—Å–ø–æ—Ä—Ç!
</div>
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω—ã —Ç–µ—Å—Ç—ã –≤ `__tests__/services/pdf-export/EnhancedPdfGenerator.test.ts`:

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫—Ä–∞–µ–≤—ã—Ö —Å–ª—É—á–∞–µ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Ç–µ–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
- –¢–µ—Å—Ç—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –±–ª–æ–∫–æ–≤

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

```bash
npm test -- EnhancedPdfGenerator.test.ts
```

## –ú–∏–≥—Ä–∞—Ü–∏—è

–°—Ç–∞—Ä—ã–π –∫–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å. –ù–æ–≤—ã–µ —Ç–µ–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–æ–≤—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä.

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–µ–º –ø—Ä–æ—Å—Ç–æ –∏–∑–º–µ–Ω–∏—Ç–µ `template` –≤ `BookSettings`:

```typescript
// –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± (–ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å)
settings.template = 'classic';

// –ù–æ–≤—ã–π —Å–ø–æ—Å–æ–±
settings.template = 'minimal';
```

## –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- –°—Ç–∞—Ä—ã–µ —Ç–µ–º—ã (`classic`, `modern`, `romantic`, `adventure`) –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- –í–Ω–µ—à–Ω–∏–π API –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è
- –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Ç–µ–º —á–µ—Ä–µ–∑ JSON-–∫–æ–Ω—Ñ–∏–≥–∏
- –≠–∫—Å–ø–æ—Ä—Ç —Ç–µ–º –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–º –ø–µ—Ä–µ–¥ —ç–∫—Å–ø–æ—Ä—Ç–æ–º
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Markdown –≤ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ HTML

